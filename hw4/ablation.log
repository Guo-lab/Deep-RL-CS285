==========================================================

Problem 4: Hyperparameter Ablations
Testing effect of ensemble size, action sequences, and horizon

Default values: ensemble=3, actions=1000, horizon=10

----------------------------------------------

1/10: Baseline (default values)...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_l2_h250_mpcrandom_horizon10_actionseq1000_09-01-2026_04-32-37
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -554.2968782163068


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -283.14741847852946


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -279.8796471985403


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -276.66706713156816


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -292.9950342603207


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -283.6911331171081


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -273.4092699985912


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -280.112970619252


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -270.06863936620033


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -270.5855676568315


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -267.5076063108565


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -269.73304774536507


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -267.23776632230874


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -260.89401052807295


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -261.87781033834113

2/10: Ensemble size = 1...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_ensemble1_l2_h250_mpcrandom_horizon10_actionseq1000_09-01-2026_04-38-57
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -462.432480613582


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -312.82997724894244


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -299.3123593181268


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -267.5160869981764


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -282.59580816514733


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -304.03729713074097


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -286.2637846307507


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -267.4485645839248


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -276.82769003867026


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -273.0736363110792


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -281.8336372720543


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -275.9827919794351


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -276.36483396490473


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -279.7980121170196


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -280.9236151487494

3/10: Ensemble size = 2...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_ensemble2_l2_h250_mpcrandom_horizon10_actionseq1000_09-01-2026_04-41-35
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -480.58510759801493


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -309.3833301253752


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -282.2634841005469


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -278.11952982406274


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -301.79848126145964


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -279.8720949324341


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -268.823411233017


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -273.0038120164467


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -277.09835289014916


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -286.3548806886598


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -294.25487530562486


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -268.58689423609684


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -272.64522710068997


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -269.70854252199496


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -274.27722447569994

4/10: Ensemble size = 5...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_ensemble5_l2_h250_mpcrandom_horizon10_actionseq1000_09-01-2026_04-45-59
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -590.1930963080001


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -345.186156069114


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -302.6054486713805


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -290.04816594862746


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -281.4062605108308


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -295.67479357908434


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -292.3883976286637


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -273.2978730959405


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -290.6960740303428


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -268.60086508361667


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -287.23419250065615


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -271.5624313496709


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -265.2740887502915


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -282.1891350371313


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -267.6344862749136

5/10: Action sequences = 500...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_actions500_l2_h250_mpcrandom_horizon10_actionseq500_09-01-2026_04-56-10
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -421.9335863761336


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -326.27596578869253


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -301.2367368564205


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -288.47594716044534


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -282.8683800467397


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -291.66090055755495


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -289.6711251761137


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -297.0731932350623


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -290.03021882651257


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -290.1155007625854


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -274.808803326198


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -286.0855668569196


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -270.7285871155903


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -282.825174480769


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -282.1011402493274

6/10: Action sequences = 1500...

7/10: Action sequences = 2000...

8/10: Horizon = 5...

9/10: Horizon = 15...

10/10: Horizon = 20...

Problem 4 completed! All 10 ablation experiments finished.
Ensemble sizes tested: 1, 2, 3, 5
Action sequences tested: 500, 1000, 1500, 2000
Horizons tested: 5, 10, 15, 20
==========================================================

Problem 4: Hyperparameter Ablations
Testing effect of ensemble size, action sequences, and horizon.  No new code.

Default values: ensemble=3, actions=1000, horizon=10

----------------------------------------------


6/10: Action sequences = 1500...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_actions1500_l2_h250_mpcrandom_horizon10_actionseq1500_09-01-2026_05-02-02
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -482.61107519911246


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -298.18645977789254


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -279.0443631314639


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -271.41513525671536


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -261.1597005532181


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -263.82657266758724


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -260.3498335599834


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -259.78196162409847


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -264.59853689503876


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -261.6396096987213


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -265.05426551535743


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -265.8020075078039


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -254.06823091949968


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -256.5987577543398


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -256.21381535600835

7/10: Action sequences = 2000...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_actions2000_l2_h250_mpcrandom_horizon10_actionseq2000_09-01-2026_05-09-39
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -455.7781729931695


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -315.57349884643565


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -278.6687079398697


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -293.1697175797987


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -263.39671035728924


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -278.20899579107464


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -254.1223523689911


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -271.24993325736887


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -258.00180204210153


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -251.9424881532927


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -264.1219367213805


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -249.7324156953704


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -257.43555613814516


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -254.78763196852498


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -271.05835640375227

8/10: Horizon = 5...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_horizon5_l2_h250_mpcrandom_horizon5_actionseq1000_09-01-2026_05-19-30
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -641.965719841414


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -326.92884878297934


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -325.96316719226957


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -284.7855663573837


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -263.5027117893959


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -253.3864795324186


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -257.7717815219214


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -275.68398169063073


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -263.50163094217726


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -257.000168790341


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -244.97167264473887


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -259.90025112089677


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -244.13453007202946


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -262.47080153749874


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -250.9752244706014

9/10: Horizon = 15...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_horizon15_l2_h250_mpcrandom_horizon15_actionseq1000_09-01-2026_05-23-26
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -393.2400704094066


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -308.0403421527435


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -305.6662951057852


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -299.11676223950275


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -302.03863262735166


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -286.3668112019881


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -295.6804195962395


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -298.20873630454827


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -292.6567595204946


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -297.74729484423017


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -300.5851009799426


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -282.87644980353383


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -300.10550524672965


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -285.774992087786


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -285.1542157436308

10/10: Horizon = 20...
########################
logging outputs to  /home/siqi/Desktop/homework_fall2023-main/hw4/cs285/scripts/../../data/reacher-cs285-v0_reacher_ablation_horizon20_l2_h250_mpcrandom_horizon20_actionseq1000_09-01-2026_05-32-38
########################
Using GPU id 0


********** Iteration 0 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -462.975131326687


********** Iteration 1 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -384.3406197441337


********** Iteration 2 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -322.191861264194


********** Iteration 3 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -318.7497019927418


********** Iteration 4 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -302.37821992911887


********** Iteration 5 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -301.77076370378035


********** Iteration 6 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -291.200458486146


********** Iteration 7 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -308.3423757410154


********** Iteration 8 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -300.38233337289137


********** Iteration 9 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -296.7471911018139


********** Iteration 10 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -309.2085739999827


********** Iteration 11 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -307.90783111265773


********** Iteration 12 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -303.8539825286733


********** Iteration 13 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -303.6942583593119


********** Iteration 14 ************
Collecting data...
Training agent...
Evaluating 10 rollouts...
Average eval return: -294.7281717210744

Problem 4 completed! All 10 ablation experiments finished.
Ensemble sizes tested: 1, 2, 3, 5
Action sequences tested: 500, 1000, 1500, 2000
Horizons tested: 5, 10, 15, 20

Experiment 4 completed!
